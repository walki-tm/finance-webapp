# 📋 Finance WebApp - Convenzioni del Progetto

> **⚠️ IMPORTANTE**: Questo file deve essere letto e seguito rigorosamente da tutti gli sviluppatori e agenti AI che lavorano su questo progetto.

## 🏗️ Architettura Generale

### Stack Tecnologico
- **Frontend**: React + Vite + TailwindCSS
- **Backend**: Node.js + Express + Prisma ORM
- **Database**: PostgreSQL
- **Autenticazione**: JWT
- **UI Components**: Custom components con Headless UI

---

## 📁 Struttura Directory

### Frontend (`/src`)
```
src/
├── components/           # Componenti riutilizzabili
│   ├── ui/              # Componenti base UI (Button, Input, etc.)
│   ├── forms/           # Componenti form specifici
│   ├── charts/          # Componenti grafici e visualizzazioni
│   └── layout/          # Componenti layout (Header, Sidebar, etc.)
├── features/            # Feature-based organization
│   ├── auth/           # Autenticazione
│   ├── dashboard/      # Dashboard principale
│   ├── categories/     # Gestione categorie
│   ├── transactions/   # Gestione transazioni
│   └── reports/        # Report e analytics
├── hooks/              # Custom React hooks
├── lib/                # Utilities e configurazioni
├── pages/              # Route pages (se non feature-based)
└── styles/             # CSS/SCSS globali
```

### Backend (`/server`)
```
server/
├── src/
│   ├── controllers/    # Route handlers
│   ├── services/       # Business logic
│   ├── middleware/     # Express middleware
│   ├── routes/         # Route definitions
│   ├── lib/           # Database connections, utilities
│   └── utils/         # Helper functions
├── prisma/            # Database schema e migrations
└── tests/             # Test files
```

---

## 🎯 Convenzioni di Naming

### File e Directory
- **Directories**: `kebab-case` (es: `user-profile`, `payment-methods`)
- **Components**: `PascalCase.jsx` (es: `UserCard.jsx`, `TransactionList.jsx`)
- **Hooks**: `camelCase.js` con prefisso `use` (es: `useAuth.js`, `useLocalStorage.js`)
- **Utilities**: `camelCase.js` (es: `formatCurrency.js`, `validateEmail.js`)
- **Pages**: `PascalCase.jsx` (es: `Dashboard.jsx`, `LoginPage.jsx`)

### Variabili e Funzioni
- **Variables**: `camelCase`
- **Constants**: `UPPER_SNAKE_CASE`
- **Functions**: `camelCase`
- **React Components**: `PascalCase`

### Database
- **Tables**: `snake_case` (es: `user_profiles`, `transaction_categories`)
- **Columns**: `snake_case` (es: `created_at`, `user_id`)

---

## 📝 Convenzioni di Codice

### Struttura dei File React
```jsx
// 1. Import esterni
import React, { useState, useEffect } from 'react'
import { motion } from 'framer-motion'

// 2. Import interni (utilities, hooks)
import { useAuth } from '../hooks/useAuth'
import { formatCurrency } from '../lib/utils'

// 3. Import componenti
import Button from '../components/ui/Button'
import Modal from '../components/ui/Modal'

// 4. Costanti locali
const DEFAULT_CONFIG = {
  // ...
}

/**
 * 🎯 COMPONENTE: [Nome e breve descrizione]
 * 
 * Descrive cosa fa questo componente, i suoi input principali
 * e il comportamento atteso.
 * 
 * @param {Object} props - Props del componente
 * @param {string} props.title - Titolo da visualizzare
 * @param {Function} props.onSave - Callback per salvare i dati
 */
export default function ComponentName({ title, onSave }) {
  // 5. State hooks
  const [isLoading, setIsLoading] = useState(false)
  
  // 6. Effect hooks
  useEffect(() => {
    // Inizializzazione componente
  }, [])
  
  // 7. Handler functions
  const handleSubmit = async (data) => {
    // Logica di gestione
  }
  
  // 8. Render helpers (se necessari)
  const renderContent = () => {
    // ...
  }
  
  // 9. Return JSX
  return (
    <div className="component-container">
      {/* Contenuto componente */}
    </div>
  )
}
```

### Struttura dei File Backend
```js
// 1. Import dependencies
import express from 'express'
import { z } from 'zod'

// 2. Import services e utilities
import { userService } from '../services/userService.js'
import { validateRequest } from '../middleware/validation.js'

// 3. Validation schemas
const userSchema = z.object({
  name: z.string().min(1),
  email: z.string().email()
})

/**
 * 🎯 CONTROLLER: [Nome e descrizione]
 * 
 * Gestisce le richieste HTTP per [specifica funzionalità]
 * 
 * @param {Request} req - Express request
 * @param {Response} res - Express response
 * @param {NextFunction} next - Express next function
 */
export async function controllerFunction(req, res, next) {
  try {
    // Validazione input
    const validatedData = userSchema.parse(req.body)
    
    // Business logic
    const result = await userService.createUser(validatedData)
    
    // Response
    res.status(201).json(result)
  } catch (error) {
    next(error)
  }
}
```

---

## 🧩 Organizzazione per Feature

### Struttura Feature
```
features/[feature-name]/
├── components/          # Componenti specifici della feature
│   ├── [FeatureName]List.jsx
│   ├── [FeatureName]Card.jsx
│   └── [FeatureName]Form.jsx
├── hooks/              # Hooks specifici della feature
│   └── use[FeatureName].js
├── pages/              # Pagine della feature
│   └── [FeatureName]Page.jsx
├── services/           # API calls specifici
│   └── [featureName]Service.js
└── utils/              # Utilities specifiche
    └── [featureName]Utils.js
```

---

## 💬 Convenzioni Commenti

### Header di File
```js
/**
 * 📄 NOME FILE: [descrizione breve]
 * 
 * 🎯 Scopo: Descrive lo scopo principale del file
 * 
 * 🔧 Dipendenze principali:
 * - React/Express/Prisma
 * - Altre dipendenze importanti
 * 
 * 📝 Note:
 * - Note importanti per il mantenimento
 * - Limitazioni o considerazioni speciali
 * 
 * @author [Nome] - [Data creazione]
 * @modified [Data ultima modifica] - [Cosa è stato modificato]
 */
```

### Sezioni di Codice
```js
// 🔸 Inizializzazione state
const [data, setData] = useState([])

// 🔸 Effect per caricamento dati
useEffect(() => {
  // logica...
}, [])

// 🔸 Handler per submit form
const handleSubmit = () => {
  // logica...
}
```

### Commenti Inline
- **TODO**: `// TODO: [descrizione cosa fare]`
- **FIXME**: `// FIXME: [descrizione problema]`
- **NOTE**: `// NOTE: [informazione importante]`
- **HACK**: `// HACK: [soluzione temporanea, spiegare perché]`

---

## 🎨 Convenzioni CSS/Styling

### TailwindCSS Guidelines
- **Responsive first**: Inizia con mobile, poi desktop
- **Utility classes**: Preferisci utility a custom CSS
- **Componenti**: Usa @apply solo per componenti riutilizzabili
- **Colori**: Usa palette consistente (definita in tailwind.config.js)

### Layout Pattern
```jsx
// Container principale
<div className="min-h-screen bg-slate-50 dark:bg-slate-900">
  
  // Card/Section
  <div className="bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-6">
    
    // Heading
    <h2 className="text-xl font-semibold text-slate-900 dark:text-slate-100 mb-4">
    
    // Content area
    <div className="space-y-4">
    
    // Buttons
    <button className="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors">
      
  </div>
</div>
```

---

## 🔐 Security Guidelines

### Frontend
- ✅ Validare sempre input lato client (ma anche server!)
- ✅ Sanitizzare dati prima del render
- ✅ Non esporre informazioni sensibili nei log browser
- ✅ Gestire correttamente i token JWT

### Backend
- ✅ Validare e sanitizzare TUTTI gli input
- ✅ Usare parametrized queries (Prisma lo fa automaticamente)
- ✅ Rate limiting sulle API
- ✅ CORS configurato correttamente
- ✅ Headers di sicurezza appropriati

---

## 📊 Performance Guidelines

### Frontend
- ✅ Usare React.memo per componenti pesanti
- ✅ Lazy loading per route e componenti
- ✅ Ottimizzare immagini e assets
- ✅ Gestire correttamente i dependency arrays negli useEffect

### Backend
- ✅ Paginazione per liste grandi
- ✅ Query ottimizzate con select specifici
- ✅ Caching appropriato
- ✅ Compressione response

---

## 🧪 Testing Guidelines

### Convenzioni Test
- **Unit tests**: `[filename].test.js`
- **Integration tests**: `[filename].integration.test.js`
- **E2E tests**: `[filename].e2e.test.js`

### Coverage Target
- **Minimum**: 70% overall
- **Controllers**: 80%+
- **Services**: 85%+
- **Utils**: 90%+

---

## 🚀 Deployment Guidelines

### Environment Variables
```bash
# Development
NODE_ENV=development
DATABASE_URL=postgresql://...
JWT_SECRET=dev_secret_key

# Production
NODE_ENV=production
DATABASE_URL=postgresql://...
JWT_SECRET=super_secure_production_key
```

### Build Process
1. ✅ Tests devono passare
2. ✅ Linting deve essere pulito
3. ✅ Build deve essere successful
4. ✅ Environment variables configurate
5. ✅ Database migrations applicate

---

## 📚 Riferimenti e Risorse

### Documentazione
- [React Documentation](https://react.dev/)
- [Tailwind CSS](https://tailwindcss.com/)
- [Prisma Documentation](https://www.prisma.io/docs)

### Tools
- **Code Formatter**: Prettier
- **Linter**: ESLint
- **Git Hooks**: Husky (se configurato)

---

## ⚡ Quick Commands

```bash
# Frontend
npm run dev          # Avvia dev server
npm run build        # Build produzione
npm run preview      # Preview build
npm run lint         # Run linter

# Backend
npm run dev          # Avvia server dev
npm run start        # Avvia server prod
npm run db:migrate   # Run migrations
npm run db:seed      # Seed database
```

---

**🔄 Ultimo aggiornamento**: 19 Gennaio 2025
**📝 Versione**: 1.0.0

> Questo documento è vivo e deve essere aggiornato quando vengono introdotte nuove convenzioni o modifiche all'architettura del progetto.
