# ðŸ“‹ Finance WebApp - Convenzioni del Progetto

> **âš ï¸ IMPORTANTE**: Questo file deve essere letto e seguito rigorosamente da tutti gli sviluppatori e agenti AI che lavorano su questo progetto.

## ðŸ—ï¸ Architettura Generale

### Stack Tecnologico
- **Frontend**: React + Vite + TailwindCSS
- **Backend**: Node.js + Express + Prisma ORM
- **Database**: PostgreSQL
- **Autenticazione**: JWT
- **UI Components**: Custom components con Headless UI

---

## ðŸ“ Struttura Directory

### Frontend (`/src`)
```
src/
â”œâ”€â”€ components/           # Componenti riutilizzabili
â”‚   â”œâ”€â”€ ui/              # Componenti base UI (Button, Input, etc.)
â”‚   â”œâ”€â”€ forms/           # Componenti form specifici
â”‚   â”œâ”€â”€ charts/          # Componenti grafici e visualizzazioni
â”‚   â””â”€â”€ layout/          # Componenti layout (Header, Sidebar, etc.)
â”œâ”€â”€ features/            # Feature-based organization
â”‚   â”œâ”€â”€ auth/           # Autenticazione
â”‚   â”œâ”€â”€ dashboard/      # Dashboard principale
â”‚   â”œâ”€â”€ categories/     # Gestione categorie
â”‚   â”œâ”€â”€ transactions/   # Gestione transazioni
â”‚   â””â”€â”€ reports/        # Report e analytics
â”œâ”€â”€ hooks/              # Custom React hooks
â”œâ”€â”€ lib/                # Utilities e configurazioni
â”œâ”€â”€ pages/              # Route pages (se non feature-based)
â””â”€â”€ styles/             # CSS/SCSS globali
```

### Backend (`/server`)
```
server/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ controllers/    # Route handlers
â”‚   â”œâ”€â”€ services/       # Business logic
â”‚   â”œâ”€â”€ middleware/     # Express middleware
â”‚   â”œâ”€â”€ routes/         # Route definitions
â”‚   â”œâ”€â”€ lib/           # Database connections, utilities
â”‚   â””â”€â”€ utils/         # Helper functions
â”œâ”€â”€ prisma/            # Database schema e migrations
â””â”€â”€ tests/             # Test files
```

---

## ðŸŽ¯ Convenzioni di Naming

### File e Directory
- **Directories**: `kebab-case` (es: `user-profile`, `payment-methods`)
- **Components**: `PascalCase.jsx` (es: `UserCard.jsx`, `TransactionList.jsx`)
- **Hooks**: `camelCase.js` con prefisso `use` (es: `useAuth.js`, `useLocalStorage.js`)
- **Utilities**: `camelCase.js` (es: `formatCurrency.js`, `validateEmail.js`)
- **Pages**: `PascalCase.jsx` (es: `Dashboard.jsx`, `LoginPage.jsx`)

### Variabili e Funzioni
- **Variables**: `camelCase`
- **Constants**: `UPPER_SNAKE_CASE`
- **Functions**: `camelCase`
- **React Components**: `PascalCase`

### Database
- **Tables**: `snake_case` (es: `user_profiles`, `transaction_categories`)
- **Columns**: `snake_case` (es: `created_at`, `user_id`)

---

## ðŸ“ Convenzioni di Codice

### Struttura dei File React
```jsx
// 1. Import esterni
import React, { useState, useEffect } from 'react'
import { motion } from 'framer-motion'

// 2. Import interni (utilities, hooks)
import { useAuth } from '../hooks/useAuth'
import { formatCurrency } from '../lib/utils'

// 3. Import componenti
import Button from '../components/ui/Button'
import Modal from '../components/ui/Modal'

// 4. Costanti locali
const DEFAULT_CONFIG = {
  // ...
}

/**
 * ðŸŽ¯ COMPONENTE: [Nome e breve descrizione]
 * 
 * Descrive cosa fa questo componente, i suoi input principali
 * e il comportamento atteso.
 * 
 * @param {Object} props - Props del componente
 * @param {string} props.title - Titolo da visualizzare
 * @param {Function} props.onSave - Callback per salvare i dati
 */
export default function ComponentName({ title, onSave }) {
  // 5. State hooks
  const [isLoading, setIsLoading] = useState(false)
  
  // 6. Effect hooks
  useEffect(() => {
    // Inizializzazione componente
  }, [])
  
  // 7. Handler functions
  const handleSubmit = async (data) => {
    // Logica di gestione
  }
  
  // 8. Render helpers (se necessari)
  const renderContent = () => {
    // ...
  }
  
  // 9. Return JSX
  return (
    <div className="component-container">
      {/* Contenuto componente */}
    </div>
  )
}
```

### Struttura dei File Backend
```js
// 1. Import dependencies
import express from 'express'
import { z } from 'zod'

// 2. Import services e utilities
import { userService } from '../services/userService.js'
import { validateRequest } from '../middleware/validation.js'

// 3. Validation schemas
const userSchema = z.object({
  name: z.string().min(1),
  email: z.string().email()
})

/**
 * ðŸŽ¯ CONTROLLER: [Nome e descrizione]
 * 
 * Gestisce le richieste HTTP per [specifica funzionalitÃ ]
 * 
 * @param {Request} req - Express request
 * @param {Response} res - Express response
 * @param {NextFunction} next - Express next function
 */
export async function controllerFunction(req, res, next) {
  try {
    // Validazione input
    const validatedData = userSchema.parse(req.body)
    
    // Business logic
    const result = await userService.createUser(validatedData)
    
    // Response
    res.status(201).json(result)
  } catch (error) {
    next(error)
  }
}
```

---

## ðŸ§© Organizzazione per Feature

### Struttura Feature
```
features/[feature-name]/
â”œâ”€â”€ components/          # Componenti specifici della feature
â”‚   â”œâ”€â”€ [FeatureName]List.jsx
â”‚   â”œâ”€â”€ [FeatureName]Card.jsx
â”‚   â””â”€â”€ [FeatureName]Form.jsx
â”œâ”€â”€ hooks/              # Hooks specifici della feature
â”‚   â””â”€â”€ use[FeatureName].js
â”œâ”€â”€ pages/              # Pagine della feature
â”‚   â””â”€â”€ [FeatureName]Page.jsx
â”œâ”€â”€ services/           # API calls specifici
â”‚   â””â”€â”€ [featureName]Service.js
â””â”€â”€ utils/              # Utilities specifiche
    â””â”€â”€ [featureName]Utils.js
```

---

## ðŸ’¬ Convenzioni Commenti

### Header di File
```js
/**
 * ðŸ“„ NOME FILE: [descrizione breve]
 * 
 * ðŸŽ¯ Scopo: Descrive lo scopo principale del file
 * 
 * ðŸ”§ Dipendenze principali:
 * - React/Express/Prisma
 * - Altre dipendenze importanti
 * 
 * ðŸ“ Note:
 * - Note importanti per il mantenimento
 * - Limitazioni o considerazioni speciali
 * 
 * @author [Nome] - [Data creazione]
 * @modified [Data ultima modifica] - [Cosa Ã¨ stato modificato]
 */
```

### Sezioni di Codice
```js
// ðŸ”¸ Inizializzazione state
const [data, setData] = useState([])

// ðŸ”¸ Effect per caricamento dati
useEffect(() => {
  // logica...
}, [])

// ðŸ”¸ Handler per submit form
const handleSubmit = () => {
  // logica...
}
```

### Commenti Inline
- **TODO**: `// TODO: [descrizione cosa fare]`
- **FIXME**: `// FIXME: [descrizione problema]`
- **NOTE**: `// NOTE: [informazione importante]`
- **HACK**: `// HACK: [soluzione temporanea, spiegare perchÃ©]`

---

## ðŸŽ¨ Convenzioni CSS/Styling

### TailwindCSS Guidelines
- **Responsive first**: Inizia con mobile, poi desktop
- **Utility classes**: Preferisci utility a custom CSS
- **Componenti**: Usa @apply solo per componenti riutilizzabili
- **Colori**: Usa palette consistente (definita in tailwind.config.js)

### Layout Pattern
```jsx
// Container principale
<div className="min-h-screen bg-slate-50 dark:bg-slate-900">
  
  // Card/Section
  <div className="bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-6">
    
    // Heading
    <h2 className="text-xl font-semibold text-slate-900 dark:text-slate-100 mb-4">
    
    // Content area
    <div className="space-y-4">
    
    // Buttons
    <button className="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors">
      
  </div>
</div>
```

---

## ðŸ” Security Guidelines

### Frontend
- âœ… Validare sempre input lato client (ma anche server!)
- âœ… Sanitizzare dati prima del render
- âœ… Non esporre informazioni sensibili nei log browser
- âœ… Gestire correttamente i token JWT

### Backend
- âœ… Validare e sanitizzare TUTTI gli input
- âœ… Usare parametrized queries (Prisma lo fa automaticamente)
- âœ… Rate limiting sulle API
- âœ… CORS configurato correttamente
- âœ… Headers di sicurezza appropriati

---

## ðŸ“Š Performance Guidelines

### Frontend
- âœ… Usare React.memo per componenti pesanti
- âœ… Lazy loading per route e componenti
- âœ… Ottimizzare immagini e assets
- âœ… Gestire correttamente i dependency arrays negli useEffect

### Backend
- âœ… Paginazione per liste grandi
- âœ… Query ottimizzate con select specifici
- âœ… Caching appropriato
- âœ… Compressione response

---

## ðŸ§ª Testing Guidelines

### Convenzioni Test
- **Unit tests**: `[filename].test.js`
- **Integration tests**: `[filename].integration.test.js`
- **E2E tests**: `[filename].e2e.test.js`

### Coverage Target
- **Minimum**: 70% overall
- **Controllers**: 80%+
- **Services**: 85%+
- **Utils**: 90%+

---

## ðŸš€ Deployment Guidelines

### Environment Variables
```bash
# Development
NODE_ENV=development
DATABASE_URL=postgresql://...
JWT_SECRET=dev_secret_key

# Production
NODE_ENV=production
DATABASE_URL=postgresql://...
JWT_SECRET=super_secure_production_key
```

### Build Process
1. âœ… Tests devono passare
2. âœ… Linting deve essere pulito
3. âœ… Build deve essere successful
4. âœ… Environment variables configurate
5. âœ… Database migrations applicate

---

## ðŸ“š Riferimenti e Risorse

### Documentazione
- [React Documentation](https://react.dev/)
- [Tailwind CSS](https://tailwindcss.com/)
- [Prisma Documentation](https://www.prisma.io/docs)

### Tools
- **Code Formatter**: Prettier
- **Linter**: ESLint
- **Git Hooks**: Husky (se configurato)

---

## âš¡ Quick Commands

```bash
# Frontend
npm run dev          # Avvia dev server
npm run build        # Build produzione
npm run preview      # Preview build
npm run lint         # Run linter

# Backend
npm run dev          # Avvia server dev
npm run start        # Avvia server prod
npm run db:migrate   # Run migrations
npm run db:seed      # Seed database
```

---

**ðŸ”„ Ultimo aggiornamento**: 19 Gennaio 2025
**ðŸ“ Versione**: 1.0.0

> Questo documento Ã¨ vivo e deve essere aggiornato quando vengono introdotte nuove convenzioni o modifiche all'architettura del progetto.
